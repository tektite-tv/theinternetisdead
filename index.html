<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>welcome to TheInternetIsDead.org</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    /* KEEP YOUR EXISTING CSS HERE, UNCHANGED */
  </style>
</head>
<body>

  <!-- Injected header + main -->
  <div id="site-header"></div>
  <div id="site-main"></div>

  <!-- MARKDOWN -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <script>
    // Load header.html and main.html, then initialize the interactive stuff.
    Promise.all([
      fetch('header.html').then(r => r.text()),
      fetch('main.html').then(r => r.text())
    ]).then(([headerHTML, mainHTML]) => {
      document.getElementById('site-header').innerHTML = headerHTML;
      document.getElementById('site-main').innerHTML = mainHTML;

      // Now that #bubbles/#spinner/#readme exist, run your original logic:
      initPage();
    }).catch(err => {
      console.error("Failed to load header/main:", err);
    });

    function initPage() {
      /* ===== LOAD README ===== */
      fetch('readme.md')
        .then(r => r.text())
        .then(md => {
          document.getElementById('readme').innerHTML = marked.parse(md);
        });

      /* ===== BUBBLES ===== */
      const bubbleField = document.getElementById('bubbles');
      const bubbles = [];
      const COUNT = 50;

      for (let i = 0; i < COUNT; i++) {
        const el = document.createElement('div');
        el.className = 'bubble';

        const size = 30 + Math.random() * 100;
        el.style.width = el.style.height = size + 'px';

        const b = {
          el,
          x: Math.random() * window.innerWidth,
          y: Math.random() * window.innerHeight,
          vx: 0,
          vy: 0
        };

        bubbleField.appendChild(el);
        bubbles.push(b);
      }

      /* ===== SPINNER ===== */
      const spinner = document.getElementById('spinner');
      let rotX = 0;
      let rotY = 0;
      let dragging = false;
      let lastX = 0;
      let lastY = 0;

      spinner.addEventListener('mousedown', e => {
        dragging = true;
        lastX = e.clientX;
        lastY = e.clientY;
      });

      window.addEventListener('mouseup', () => dragging = false);

      window.addEventListener('mousemove', e => {
        if (!dragging) return;

        const dx = e.clientX - lastX;
        const dy = e.clientY - lastY;

        rotY += dx * 0.3;
        rotX -= dy * 0.3;

        bubbles.forEach(b => {
          b.vx += dx * 0.02;
          b.vy += dy * 0.02;
        });

        lastX = e.clientX;
        lastY = e.clientY;
      });

      function animate() {
        spinner.style.transform =
          `translate(-50%, -50%) rotateX(${rotX}deg) rotateY(${rotY}deg)`;

        bubbles.forEach(b => {
          b.x += b.vx;
          b.y += b.vy;
          b.vx *= 0.9;
          b.vy *= 0.9;
          b.el.style.transform = `translate(${b.x}px, ${b.y}px)`;
        });

        requestAnimationFrame(animate);
      }

      animate();
    }
  </script>

</body>
</html>
