<style>
  .container {
    position: relative;
    height: 100%;
    padding-top: 96px;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .scene {
  position: relative;
  width: 100%;
  height: 100%;
}

  .bubble-field {
    position: absolute;
    inset: 0;
  }

  .bubble {
    position: absolute;
    border-radius: 50%;
    background: radial-gradient(
      circle at 30% 30%,
      rgba(255,255,255,0.9),
      rgba(0,255,180,0.25) 45%,
      rgba(0,0,0,0.15) 75%
    );
    box-shadow:
      inset -8px -8px 16px rgba(0,0,0,0.3),
      0 0 18px rgba(0,255,180,0.2);
  }

  .readme-wrapper {
  position: relative;
  transform-style: preserve-3d;
  pointer-events: auto;
  cursor: grab;
}

  #readme {
    max-width: 800px;
    padding: 32px;
    background: rgba(0, 0, 0, 0.55);
    color: #e6fff6;
    border-radius: 12px;
  }
</style>

<main>
  <div class="container">
    <div class="scene">
      <div class="bubble-field" id="bubbles"></div>

      <div class="readme-wrapper" id="spinner">
        <div id="readme"></div>
      </div>
    </div>
  </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<script>
  // This script runs AFTER main.html is injected, so the DOM exists.

  /* LOAD README */
  fetch("readme.md")
    .then(r => r.text())
    .then(md => {
      document.getElementById("readme").innerHTML = marked.parse(md);
    });

  /* BUBBLES */
  const bubbleField = document.getElementById("bubbles");
  const bubbles = [];
  const COUNT = 50;

  for (let i = 0; i < COUNT; i++) {
    const el = document.createElement("div");
    el.className = "bubble";

    const size = 30 + Math.random() * 100;
    el.style.width = el.style.height = size + "px";

    const b = {
      el,
      x: Math.random() * window.innerWidth,
      y: Math.random() * window.innerHeight,
      vx: 0,
      vy: 0
    };

    bubbleField.appendChild(el);
    bubbles.push(b);
  }

  /* SPINNER */
  const spinner = document.getElementById("spinner");
  let rotX = 0;
  let rotY = 0;
  let dragging = false;
  let lastX = 0;
  let lastY = 0;

  spinner.addEventListener("mousedown", e => {
    dragging = true;
    lastX = e.clientX;
    lastY = e.clientY;
  });

  window.addEventListener("mouseup", () => dragging = false);

  window.addEventListener("mousemove", e => {
    if (!dragging) return;

    const dx = e.clientX - lastX;
    const dy = e.clientY - lastY;

    rotY += dx * 0.3;
    rotX -= dy * 0.3;

    bubbles.forEach(b => {
      b.vx += dx * 0.02;
      b.vy += dy * 0.02;
    });

    lastX = e.clientX;
    lastY = e.clientY;
  });

  function animate() {
    spinner.style.transform =
      `translate(-50%, -50%) rotateX(${rotX}deg) rotateY(${rotY}deg)`;

    bubbles.forEach(b => {
      b.x += b.vx;
      b.y += b.vy;
      b.vx *= 0.9;
      b.vy *= 0.9;
      b.el.style.transform = `translate(${b.x}px, ${b.y}px)`;
    });

    requestAnimationFrame(animate);
  }

  animate();
</script>
