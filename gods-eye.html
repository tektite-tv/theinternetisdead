<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fractal Bloom Engine</title>
<style>
    body {
        margin: 0;
        background: black;
        overflow: hidden;
    }
    canvas {
        position: absolute;
        top: 0;
        left: 0;
    }
</style>
</head>
<body>

<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
resize();
window.onresize = resize;

// ===== FRACTAL CONFIGURATION =====
const baseColors = ["red", "green", "blue"];
const shrinkFactor = 0.65;      // B: Medium shrink
const twist = Math.PI / 12;     // rotation per generation
const generations = 12;         // recursion depth
let zoom = 1;
const zoomSpeed = 0.004;        // outward zoom

// ===== DRAW A SINGLE SQUARE =====
function drawSquare(size, angle, color) {
    ctx.save();
    ctx.translate(canvas.width / 2, canvas.height / 2);
    ctx.rotate(angle);

    ctx.strokeStyle = color;
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.rect(-size/2, -size/2, size, size);
    ctx.stroke();

    ctx.restore();
}

// ===== DRAW FRACTAL RECURSIVELY =====
function drawFractal(size, angle, depth) {
    if (depth === 0 || size < 1) return;

    // draw square
    drawSquare(size, angle, baseColors[depth % 3]);

    // compute child size + angle
    const newSize = size * shrinkFactor;

    // vertices of the square in parent's coordinate system
    const verts = [
        [ size/2,  size/2],
        [-size/2,  size/2],
        [-size/2, -size/2],
        [ size/2, -size/2]
    ];

    // for each vertex: spawn child fractal
    for (let i = 0; i < 4; i++) {

        ctx.save();
        ctx.translate(canvas.width/2, canvas.height/2);
        ctx.rotate(angle);

        // move to vertex
        ctx.translate(verts[i][0], verts[i][1]);

        // draw the recursive child at this vertex
        ctx.translate(-canvas.width/2, -canvas.height/2);
        drawFractal(newSize, angle + twist, depth - 1);

        ctx.restore();
    }
}

// ===== ANIMATION LOOP =====
function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    zoom += zoomSpeed;

    const initialSize = 20 * zoom;
    const initialAngle = performance.now() * 0.0002;

    drawFractal(initialSize, initialAngle, generations);

    requestAnimationFrame(animate);
}

animate();
</script>

</body>
</html>
