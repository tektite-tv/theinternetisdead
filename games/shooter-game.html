<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bananarama Arena</title>
<style>
  html,body{margin:0;overflow:hidden;background:#000;font-family:monospace;}
  canvas{display:block;background:#111;}
  #hud{
    position:absolute;top:10px;left:10px;color:#0f0;
    text-shadow:1px 1px 3px #000;
  }
</style>
</head>
<body>
<div id="hud">Lives: 3 | Kills: 0</div>
<canvas id="game"></canvas>
<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
let w,h;function resize(){w=canvas.width=window.innerWidth;h=canvas.height=window.innerHeight;}
window.addEventListener("resize",resize);resize();

// World parameters
const ARENA_W=4000, ARENA_H=4000;
const OBSTACLE_COUNT=50;
const SPAWN_INTERVAL=80; // frames
const MAX_ENEMIES=80;

const playerImg=new Image(); playerImg.src="/media/images/gifs/bananarama.gif";
const enemyImg=new Image(); enemyImg.src="/media/images/gifs/skeleton.gif";

let player={x:ARENA_W/2,y:ARENA_H/2,r:24,speed:4,lives:3,kills:0,walking:false};
let bullets=[], enemies=[], obstacles=[], frames=0;
let camX=0,camY=0;

// Create random obstacles
function spawnObstacles(){
  for(let i=0;i<OBSTACLE_COUNT;i++){
    obstacles.push({
      x:Math.random()*ARENA_W,
      y:Math.random()*ARENA_H,
      w:100+Math.random()*200,
      h:60+Math.random()*100
    });
  }
}
spawnObstacles();

// Controls
const keys={};
window.addEventListener("keydown",e=>keys[e.key.toLowerCase()]=true);
window.addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);
canvas.addEventListener("click",shoot);
function shoot(e){
  const rect=canvas.getBoundingClientRect();
  const mx=e.clientX-rect.left,my=e.clientY-rect.top;
  const angle=Math.atan2(my-h/2,mx-w/2);
  bullets.push({x:player.x,y:player.y,dx:Math.cos(angle)*10,dy:Math.sin(angle)*10});
}

// Collision
function collidesRect(x,y,r,rect){
  return x+r>rect.x && x-r<rect.x+rect.w && y+r>rect.y && y-r<rect.y+rect.h;
}
function collides(x,y,r){
  for(const o of obstacles)
    if(collidesRect(x,y,r,o))return true;
  return false;
}

// Enemy spawning
function spawnEnemy(){
  const side=Math.floor(Math.random()*4);
  let x,y;
  if(side===0){x=Math.random()*ARENA_W;y=-100;}
  else if(side===1){x=ARENA_W+100;y=Math.random()*ARENA_H;}
  else if(side===2){x=Math.random()*ARENA_W;y=ARENA_H+100;}
  else{x=-100;y=Math.random()*ARENA_H;}
  enemies.push({x,y,r:24,hp:3});
}

// Update
function update(){
  frames++;
  // Player move
  let nx=player.x,ny=player.y;
  if(keys['w'])ny-=player.speed;
  if(keys['s'])ny+=player.speed;
  if(keys['a'])nx-=player.speed;
  if(keys['d'])nx+=player.speed;
  player.walking = keys['w']||keys['a']||keys['s']||keys['d'];
  if(!collides(nx,ny,player.r)){player.x=nx;player.y=ny;}

  // Bullets
  bullets.forEach(b=>{b.x+=b.dx;b.y+=b.dy;});
  bullets=bullets.filter(b=>b.x>0&&b.x<ARENA_W&&b.y>0&&b.y<ARENA_H&&!collides(b.x,b.y,4));

  // Spawn enemies
  if(frames%SPAWN_INTERVAL===0 && enemies.length<MAX_ENEMIES) spawnEnemy();

  // Enemies move
  enemies.forEach(e=>{
    const dx=player.x-e.x,dy=player.y-e.y;
    const dist=Math.hypot(dx,dy);
    const nx=e.x+(dx/dist)*1.5,ny=e.y+(dy/dist)*1.5;
    if(!collides(nx,ny,e.r)){e.x=nx;e.y=ny;}
  });

  // Bullet hits
  bullets.forEach((b,bi)=>{
    enemies.forEach((e,ei)=>{
      const dx=b.x-e.x,dy=b.y-e.y;
      if(Math.hypot(dx,dy)<e.r){e.hp--;bullets.splice(bi,1);
        if(e.hp<=0){enemies.splice(ei,1);player.kills++;}
      }
    });
  });

  // Enemy hits player
  enemies.forEach(e=>{
    if(Math.hypot(e.x-player.x,e.y-player.y)<e.r+player.r){
      player.lives--;
      enemies=[];
      player.x=ARENA_W/2;player.y=ARENA_H/2;
    }
  });

  camX=player.x-w/2;
  camY=player.y-h/2;
  document.getElementById("hud").textContent=`Lives: ${player.lives} | Kills: ${player.kills}`;
}

// Draw
let t=0;
function draw(){
  ctx.fillStyle="#000";ctx.fillRect(0,0,w,h);
  ctx.save();ctx.translate(-camX,-camY);

  // Obstacles
  ctx.fillStyle="#333";
  obstacles.forEach(o=>ctx.fillRect(o.x,o.y,o.w,o.h));

  // Bullets
  ctx.fillStyle="#ff0";
  bullets.forEach(b=>ctx.fillRect(b.x-2,b.y-2,4,4));

  // Enemies
  enemies.forEach(e=>{
    ctx.drawImage(enemyImg,e.x-e.r,e.y-e.r,e.r*2,e.r*2);
  });

  // Player wobble animation
  t+=0.05;
  const speed = player.walking ? 6 : 3;
  const pulse = 1 + Math.sin(t*speed)*0.05;
  const tilt = Math.sin(t*2)*0.15;
  ctx.save();
  ctx.translate(player.x,player.y);
  ctx.rotate(tilt);
  ctx.scale(pulse,pulse);
  ctx.drawImage(playerImg,-player.r,-player.r,player.r*2,player.r*2);
  ctx.restore();

  ctx.restore();
}

// Loop
function loop(){update();draw();requestAnimationFrame(loop);}
loop();
</script>
</body>
</html>
