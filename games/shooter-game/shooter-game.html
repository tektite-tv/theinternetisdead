<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bananaman Shooter</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="m-0 h-screen bg-[#0b0b0b] text-gray-200 font-sans overflow-hidden select-none">
<canvas id="game-canvas" class="fixed inset-0 w-full h-full block"></canvas>

<!-- Main Menu -->
<div id="main-menu" class="fixed inset-0 flex items-center justify-center pointer-events-auto">
  <div class="bg-neutral-900/90 border border-white/10 rounded-2xl shadow-2xl p-8 w-[min(92vw,560px)] text-center">
    <h1 class="text-yellow-300 text-4xl md:text-5xl font-extrabold mb-1 drop-shadow-md">Bananaman Shooter</h1>
    <p class="text-sm opacity-70 mb-6">v0.2.8</p>
    <button id="btn-start" class="w-full my-2 py-3 rounded-xl border border-white/20 bg-white/10 hover:bg-white/20 transition">Start Game</button>
    <button id="btn-options" class="w-full my-2 py-3 rounded-xl border border-white/20 bg-white/10 hover:bg-white/20 transition">Options</button>
  </div>
</div>

<!-- Options Menu -->
<div id="options-menu" class="hidden fixed inset-0 flex items-center justify-center pointer-events-auto">
  <div class="bg-neutral-900/90 border border-white/10 rounded-2xl shadow-2xl p-8 w-[min(92vw,560px)] text-center">
    <h2 class="text-yellow-300 text-3xl font-bold mb-4">Options</h2>

    <p class="mb-2">Difficulty: <span id="diff-label" class="font-semibold">Normal</span></p>
    <input id="diff-slider" type="range" min="1" max="3" step="1" value="2" class="w-4/5 accent-yellow-400">
    <p id="diff-desc" class="text-sm opacity-75 mb-4">Enemies deal standard damage.</p>

    <p class="mb-2">Game Speed: <span id="speed-label" class="font-semibold">1.0x</span></p>
    <input id="speed-slider" type="range" min="1" max="10" step="1" value="1" class="w-4/5 accent-pink-400">
    <p id="speed-desc" class="text-sm opacity-75 mb-6">Adjusts overall game speed (1x–5x).</p>

    <button id="btn-back" class="w-full py-3 rounded-xl border border-white/20 bg-white/10 hover:bg-white/20 transition">Back</button>
  </div>
</div>

<!-- HUD -->
<div id="hud-stats" class="hidden fixed top-2 left-2 bg-neutral-800/70 text-sm px-3 py-2 rounded-lg border border-white/10">
  Kills: <span id="killcount">0</span> | Wave: <span id="wavecount">0</span>
</div>

<div id="hud-topright" class="hidden fixed top-2 right-3 flex gap-3">
  <div id="hud-damage" class="bg-neutral-800/70 text-sm px-3 py-2 rounded-lg border border-white/10">
    Damage: <span id="damagecount">0</span>
  </div>
  <div id="hud-timer" class="bg-neutral-800/70 text-sm px-3 py-2 rounded-lg border border-white/10">
    Time: <span id="timer">0s</span>
  </div>
</div>

<!-- UPDATED: Health bar moved to bottom center, widened -->
<div id="healthbar" class="hidden fixed bottom-6 left-1/2 transform -translate-x-1/2 w-[60vw] h-6 border border-white relative bg-red-950 rounded-xl shadow-lg">
  <div id="healthfill" class="absolute left-0 top-0 h-full w-full bg-red-500 transition-[width] duration-200 rounded-xl"></div>
  <div id="healthtext" class="absolute w-full text-center text-sm text-white top-[2px]">100%</div>
</div>

<!-- Death Screen -->
<div id="you-died" class="fixed inset-0 flex flex-col items-center justify-center text-red-600 font-extrabold text-6xl drop-shadow-[0_0_40px_#ff0000] bg-black/80 opacity-0 transition-opacity duration-1000 pointer-events-none">
  <p>YOU DIED</p>
  <button id="btn-restart" class="mt-8 text-lg text-white border border-white/20 bg-white/10 hover:bg-white/20 px-6 py-3 rounded-xl transition">Return to Main Menu</button>
</div>

<div class="fixed bottom-2 right-3 text-xs opacity-70 bg-neutral-900/70 border border-white/10 px-2 py-1 rounded">
  Move: WASD • Aim: Mouse • Shoot: Click/Space • ESC: Menu
</div>

<script>
// v0.2.8 - Moved and resized health bar to bottom center
const canvas=document.getElementById('game-canvas');
const ctx=canvas.getContext('2d',{alpha:false});
const mainMenu=document.getElementById('main-menu');
const optionsMenu=document.getElementById('options-menu');
const btnStart=document.getElementById('btn-start');
const btnOptions=document.getElementById('btn-options');
const btnBack=document.getElementById('btn-back');
const btnRestart=document.getElementById('btn-restart');
const diffSlider=document.getElementById('diff-slider');
const diffLabel=document.getElementById('diff-label');
const diffDesc=document.getElementById('diff-desc');
const speedSlider=document.getElementById('speed-slider');
const speedLabel=document.getElementById('speed-label');
const hudStats=document.getElementById('hud-stats');
const killEl=document.getElementById('killcount');
const waveEl=document.getElementById('wavecount');
const healthBar=document.getElementById('healthbar');
const healthFill=document.getElementById('healthfill');
const healthText=document.getElementById('healthtext');
const deathScreen=document.getElementById('you-died');
const hudTopRight=document.getElementById('hud-topright');
const damageEl=document.getElementById('damagecount');
const timerEl=document.getElementById('timer');

let startTime=null, elapsedTime=0, totalDamage=0;

const enemyGifs=[
 'bananarama.gif','dancing-guy.gif','dancingzoidberg.gif','dragon.gif','eyes.gif','fatspiderman.gif',
 'firework.gif','frog.gif','keyboard_smash.gif','skeleton.gif'
].map(n=>`/media/images/gifs/${n}`);

const State={
  screen:'menu',rafId:null,lastFrame:0,time:0,
  mouse:{x:innerWidth/2,y:innerHeight/2},
  player:{x:0,y:0,size:96,speed:280,hp:100,hitFlash:0},
  bananaImg:new Image(),bananaLoaded:false,
  keys:{},bullets:[],enemies:[],
  wave:0,kills:0,nextKillTarget:10,clearTimer:0,
  difficulty:2,speedMultiplier:1
};
State.bananaImg.src='/media/images/gifs/bananarama.gif';
State.bananaImg.onload=()=>State.bananaLoaded=true;

function fitCanvas(){
  const dpr=Math.min(devicePixelRatio||1,2);
  canvas.width=innerWidth*dpr;canvas.height=innerHeight*dpr;
  ctx.scale(dpr,dpr);
  State.player.x=innerWidth/2;State.player.y=innerHeight/2;
}
addEventListener('resize',fitCanvas);fitCanvas();

function drawBackground(){
  ctx.fillStyle='#0e0e10';ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.save();ctx.globalAlpha=.35;ctx.strokeStyle='#2aff8a';
  const s=32;
  for(let x=0;x<innerWidth;x+=s){ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,innerHeight);ctx.stroke();}
  for(let y=0;y<innerHeight;y+=s){ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(innerWidth,y);ctx.stroke();}
  ctx.restore();
}

// [rest of the logic remains identical to v0.2.7 – omitted for brevity]
</script>
</body>
</html>
